<!DOCTYPE html>
<html>
<head><title>/StatsdClient/MetricsTimer.cs</title></head>

<style>
.num {
  text-align:right;
  padding-right:3px;
  font-size:80%;
}
.hit-count-good {
  background-color:#73b973;
}
.hit-count-bad {
  background-color:#ff7373;
}
.code {
  font-family:monospace;
}
.nm-cov-good {
  background-color:#a2d0a2;
}
.nm-cov-bad {
  background-color:#ffa2a2;
}
pre {
  margin:0px;
}
body {
  font-family:sans-serif;
}
</style>
<body>
<table cellspacing='0' cellpadding='0'>
<tr><td class='num'>1&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>using System;</span></pre></td></tr>
<tr><td class='num'>2&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'></span></pre></td></tr>
<tr><td class='num'>3&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>namespace StatsdClient</span></pre></td></tr>
<tr><td class='num'>4&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>{</span></pre></td></tr>
<tr><td class='num'>5&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>    public class MetricsTimer : IDisposable</span></pre></td></tr>
<tr><td class='num'>6&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>    {</span></pre></td></tr>
<tr><td class='num'>7&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>        private readonly string _name;</span></pre></td></tr>
<tr><td class='num'>8&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>        private readonly Stopwatch _stopWatch;</span></pre></td></tr>
<tr><td class='num'>9&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>        private bool _disposed;</span></pre></td></tr>
<tr><td class='num'>10&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>        private readonly double _sampleRate;</span></pre></td></tr>
<tr><td class='num'>11&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>        private readonly string[] _tags;</span></pre></td></tr>
<tr><td class='num'>12&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'></span></pre></td></tr>
<tr><td class='num'>13&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>        public MetricsTimer(string name, double sampleRate = 1.0, string[] tags = null)</span></pre></td></tr>
<tr><td class='num'>14&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>        {</span></pre></td></tr>
<tr><td class='num'>15&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>            _name = name;</span></pre></td></tr>
<tr><td class='num'>16&nbsp;</td><td class='num hit-count-good'>20&nbsp;</td><td><pre><span class='code nm-cov-good'>            _stopWatch = new Stopwatch();</span></pre></td></tr>
<tr><td class='num'>17&nbsp;</td><td class='num hit-count-good'>20&nbsp;</td><td><pre><span class='code nm-cov-good'>            _stopWatch.Start();</span></pre></td></tr>
<tr><td class='num'>18&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>            _sampleRate = sampleRate;</span></pre></td></tr>
<tr><td class='num'>19&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>            _tags = tags;</span></pre></td></tr>
<tr><td class='num'>20&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>        }</span></pre></td></tr>
<tr><td class='num'>21&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'></span></pre></td></tr>
<tr><td class='num'>22&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>        public void Dispose()</span></pre></td></tr>
<tr><td class='num'>23&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>        {</span></pre></td></tr>
<tr><td class='num'>24&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>            if (!_disposed)</span></pre></td></tr>
<tr><td class='num'>25&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>            {</span></pre></td></tr>
<tr><td class='num'>26&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>                _disposed = true;</span></pre></td></tr>
<tr><td class='num'>27&nbsp;</td><td class='num hit-count-good'>20&nbsp;</td><td><pre><span class='code nm-cov-good'>                _stopWatch.Stop();</span></pre></td></tr>
<tr><td class='num'>28&nbsp;</td><td class='num hit-count-good'>30&nbsp;</td><td><pre><span class='code nm-cov-good'>                DogStatsd.Timer(_name, _stopWatch.ElapsedMilliseconds(), _sampleRate, _tags);</span></pre></td></tr>
<tr><td class='num'>29&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>            }</span></pre></td></tr>
<tr><td class='num'>30&nbsp;</td><td class='num hit-count-good'>10&nbsp;</td><td><pre><span class='code nm-cov-good'>        }</span></pre></td></tr>
<tr><td class='num'>31&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>    }</span></pre></td></tr>
<tr><td class='num'>32&nbsp;</td><td class='num'>&nbsp;&nbsp;</td><td><pre><span class='code'>}</span></pre></td></tr>
</table>
</body>
